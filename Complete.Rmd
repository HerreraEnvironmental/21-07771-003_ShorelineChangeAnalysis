---
title: 'NANOOS Profiles: SCA Shoreline Characterization'
author: "Regina Lionheart"
date: "2023-03-01"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# *TODO BEFORE COMPLETION*

I still need to get the complete list of profiles. I don't think I can do this without Jon.
Return to boxplots as the best method for characterizing overall profile movement.

## Overview

NANOOS Shoreline profiles in x y z format (easting northing elevation).
Naming convention is prof_X_ttYY.out where prof is short for profile, X is the profile number, tt is a season code (e.g. f = fall) and YY is the year, in the format of the last two digis (i.e, "98" is 1998", "00" is 2000, "08" is 2008, etc).

Quite a few profiles are null (empty) and will be removed and noted. See the "Explore Profiles" script for more information.

Some of the profiles had non-conforming names: "BigE06", "beachface", etc. These do not represent a large portion of the files and have not been included in the analysis. 

Two duplicates were removed from original set: see accompanying script "duplicate_test.R".


### Metadata
The vertical datum is NAVD88.
The horizontal is WA State Plane South. All of the units are in meters.

## Load required packages
```{r load packages, echo=FALSE, results='hide'}
source("scripts/src/load_packages.R")
```

## Explore profiles
```{r prep, echo=FALSE}
source("scripts/examine_profiles.R")
```


## View profiles and their locations
```{r prep, echo=FALSE}
knitr::kable(complete.geo.profiles, caption = "Profiles with matching geographic location")
```

## Individual profile, single year visualization

Select a profile of interest by entering "prof_N" below, with "N" being a profile chosen from the above list.
Select a year of interest by entering the last two digits of the year (from 98 to 18).
The output from this code chunk will print the total number of files associated with the request, as well as any empty files within the request parameters, and plot the given profile. 

This is an actual plot of the x y z coordinates to understand file format as well as the variability of a given profile, *not* a direct geographic representation of the data. The graph can be rotated using the mouse. Hover over the lines to see the seasonal data.

```{r prep, echo=FALSE}
profile.pattern <- "prof_17"
year.pattern <- c("19")

source("scripts/src/import_profiles.R")
source("scripts/single_profile_3D.R")

single.profile.plot
```

## Individual profile, all available years visualization

Import data for a single profile, automatically including all available years.
Create a visual for the complete profile with all years. The orange horizontal plane is the MHHW mark. 
```{r, echo=FALSE}
profile.pattern <- "prof_17"

source("scripts/src/import_profiles.R")
source("scripts/complete_profile_plane.R")

complete.profile.plot
```


## BasePoint reference line and Euclidean distance as an accretion/erosion proxy

In order to quantify shoreline change, an arbitrary "BasePoint" reference line, parallel to the water, was drawn at a reasonable distance from the profiles. The profiles (aka transects) are perpendicular to this BasePoint, allowing for a reference point against which to calculate spatial change.

In order to visualize this concept, the below chunk of code visualizes 1) a simplified selection of profiles (plotted in black) compared to the BasePoint (plotted in red) and 2) an individual profile (plotted in black) and its BasePoint (plotted in red).  

```{r, echo=FALSE}
source("scripts/profiles_and_BasePoint.R")
all.basepoint.plot
single.basepoint.plot
```
Using Euclidean distance, migrations of the transects over time as compared to the BasePoint act as proxies for accretion and erosion. 

Increasing Euclidean distance = Accretion
Decreasing Euclidean distance = Erosion

## Characterizing profile elements to use for accretion and erosion proxies. 

Each profile, while following the same basic layout, comes with the variation expected from environmental data. Therefore it is important to find a method of individual profile characterization that will apply to all 4500 profiles, and can act as a reliable proxy to determine erosion or accretion.

The simplest way to do this

Find the midpoint of each profile. See where it is migrating with time.
```{r, echo=FALSE}

profile.pattern <- "prof_22|prof_23"
source("scripts/midpoint_euclidean_distance.R")
midpoint.euc.dist.plot
```


## Linear Regressions and Change Rates

Take linear regressions for only xy data

Look at a single profile and year to see the linear regression
```{r, echo=FALSE}
profile.pattern <- "prof_22"
year.pattern <- "00"
source("scripts/src/import_profiles.R")
```

```{r, echo=FALSE}
source("scripts/single_linear_reg.R")
single.linear
```

Add quartiles along the plot for data description.
```{r, echo=FALSE}
source("scripts/single_quartiles.R")
single.quartiles.plot
```


```{r, echo=FALSE}
source("scripts/quartile_ROC.R")
quartile.ROC.plot
```

Visualize where the profiles cross the MHHW mark. 
```{r, echo=FALSE}
source("scripts/MHHW_to_BP.R")
MHHW.to.BasePoint
```

How do those points change with time?
```{r, echo=FALSE}
source("scripts/MHHW_ROC.R")
MHHW.ROC.plot
```

Dumbbell plot of Euclidean distance of profile (geographic, over time)
```{r, echo=FALSE}
source("scripts/dummb")
MHHW.ROC.plot
```